<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Umfassende YOLO-basierte Hundeerkennung - Analyse und Optimierung</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="combined_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="combined_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="combined_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="combined_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="combined_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="combined_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="combined_analysis_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="combined_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="combined_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="combined_analysis_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Umfassende YOLO-basierte Hundeerkennung - Analyse und Optimierung</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="inhaltsverzeichnis" class="level1">
<h1>Inhaltsverzeichnis</h1>
<ol type="1">
<li><a href="#projektübersicht">Projektübersicht</a></li>
<li><a href="#setup-und-bibliotheken">Setup und Bibliotheken</a></li>
<li><a href="#datenüberblick-und-vorbereitung">Datenüberblick und Vorbereitung</a></li>
<li><a href="#vergleich-der-datensätze">Vergleich der Datensätze</a></li>
<li><a href="#baseline-modelle-und-trainingsstrategien">Baseline-Modelle und Trainingsstrategien</a></li>
<li><a href="#trainingsverläufe-und-metriken">Trainingsverläufe und Metriken</a></li>
<li><a href="#vergleichende-modell-performance">Vergleichende Modell-Performance</a></li>
<li><a href="#datenaugmentation-und-upsampling">Datenaugmentation und Upsampling</a></li>
<li><a href="#effekt-von-augmentation">Effekt von Augmentation</a></li>
<li><a href="#prediction-plots-modellvorhersagen">Prediction Plots: Modellvorhersagen</a></li>
<li><a href="#fehleranalyse-false-positives--negatives">Fehleranalyse: False Positives &amp; Negatives</a></li>
<li><a href="#quantitative-fehlerstatistik">Quantitative Fehlerstatistik</a></li>
<li><a href="#zusammenfassende-analysen">Zusammenfassende Analysen</a></li>
<li><a href="#diskussion-und-reflexion">Diskussion und Reflexion</a></li>
</ol>
<section id="projektübersicht" class="level2">
<h2 class="anchored" data-anchor-id="projektübersicht">Projektübersicht</h2>
<p>Diese umfassende Analyse implementiert und evaluiert verschiedene YOLO-Architekturen für die automatisierte Erkennung von Hunden in Bildern. Das Projekt kombiniert zwei Hauptansätze: die Entwicklung optimierter Baseline-Modelle mit progressiven Trainingsstrategien sowie die systematische Evaluation verschiedener Datensätze mit anschließender Datenaugmentation.</p>
<section id="forschungsfrage" class="level3">
<h3 class="anchored" data-anchor-id="forschungsfrage">Forschungsfrage</h3>
<p><strong>Wie lässt sich die Performance von YOLO-basierten Objektdetektoren für die Hundeerkennung durch progressive Trainingsstrategien und datenspezifische Optimierungen maximieren?</strong></p>
</section>
<section id="hauptziele" class="level3">
<h3 class="anchored" data-anchor-id="hauptziele">Hauptziele:</h3>
<ul>
<li><strong>Baseline-Entwicklung</strong>: Training verschiedener YOLO-Varianten (YOLOv8n, YOLOv8s, YOLOv8m)</li>
<li><strong>Progressive Trainingsoptimierung</strong>: Stufenweises Training mit steigenden Auflösungen</li>
<li><strong>Datensatz-Evaluation</strong>: Vergleichende Analyse von vier verschiedenen Hundedatensätzen</li>
<li><strong>Datenaugmentation</strong>: Systematische Verbesserung kleinerer Datensätze</li>
<li><strong>Fehleranalyse</strong>: Identifikation typischer Schwachstellen und Optimierungspotenziale</li>
<li><strong>Prediction-Analyse</strong>: Visualisierung von Modellvorhersagen und Ground Truth Vergleichen</li>
</ul>
</section>
<section id="technischer-stack" class="level3">
<h3 class="anchored" data-anchor-id="technischer-stack">Technischer Stack:</h3>
<ul>
<li><strong>Framework</strong>: Ultralytics YOLO (v8)</li>
<li><strong>Programmiersprache</strong>: Python</li>
<li><strong>Visualisierung</strong>: Matplotlib, PIL, OpenCV</li>
<li><strong>Datenverarbeitung</strong>: NumPy, Pandas, Albumentations</li>
</ul>
</section>
</section>
<section id="setup-und-bibliotheken" class="level2">
<h2 class="anchored" data-anchor-id="setup-und-bibliotheken">Setup und Bibliotheken</h2>
<div id="268ab26f" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xml.etree.ElementTree <span class="im">as</span> ET</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ultralytics <span class="im">import</span> YOLO</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yaml</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> albumentations <span class="im">as</span> A</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Matplotlib Konfiguration</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'default'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="baseline-modell-und-progressive-trainingsstrategien" class="level2">
<h2 class="anchored" data-anchor-id="baseline-modell-und-progressive-trainingsstrategien">1. Baseline-Modell und Progressive Trainingsstrategien</h2>
<section id="modellarchitekturen" class="level3">
<h3 class="anchored" data-anchor-id="modellarchitekturen">1.1 Modellarchitekturen</h3>
<p>Das Projekt evaluierte drei YOLO-Varianten: - <strong>YOLOv8n</strong>: ~3.2M Parameter, optimiert für Geschwindigkeit - <strong>YOLOv8s</strong>: ~11.2M Parameter, Balance zwischen Geschwindigkeit und Genauigkeit<br>
- <strong>YOLOv8m</strong>: ~25.9M Parameter, fokussiert auf maximale Genauigkeit</p>
</section>
<section id="progressive-trainingsstrategie" class="level3">
<h3 class="anchored" data-anchor-id="progressive-trainingsstrategie">1.2 Progressive Trainingsstrategie</h3>
<p>Die progressive Größenstrategie trainiert das Modell in drei aufeinanderfolgenden Stages mit steigenden Auflösungen: - <strong>Stage 1</strong>: 320px Auflösung (Epochen 0-20) - <strong>Stage 2</strong>: 512px Auflösung (Epochen 21-40)<br>
- <strong>Stage 3</strong>: 640px Auflösung (Epochen 41-60)</p>
</section>
<section id="hauptergebnisse-der-baseline-optimierung" class="level3">
<h3 class="anchored" data-anchor-id="hauptergebnisse-der-baseline-optimierung">1.3 Hauptergebnisse der Baseline-Optimierung</h3>
<p><strong>Beste Performance:</strong> Progressive Training mit YOLOv8s erreichte 96.86% mAP@0.5</p>
<p><strong>Quantitative Progression:</strong> - <strong>Stage 1</strong>: 90.06% mAP@0.5 - <strong>Stage 2</strong>: 94.33% mAP@0.5 (+4.27% Verbesserung) - <strong>Stage 3</strong>: 96.86% mAP@0.5 (+2.53% weitere Verbesserung) - <strong>Gesamtverbesserung</strong>: 6.80%</p>
</section>
<section id="visualisierung-der-baseline-ergebnisse" class="level3">
<h3 class="anchored" data-anchor-id="visualisierung-der-baseline-ergebnisse">1.4 Visualisierung der Baseline-Ergebnisse</h3>
<div id="d3bd1613" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Baseline Training Losses (YOLOv8n)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df_baseline <span class="op">=</span> pd.read_csv(<span class="st">'./runs/baseline_fixed/results.csv'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>grouped_baseline <span class="op">=</span> df_baseline.groupby(<span class="st">'epoch'</span>).mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Training Losses</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_baseline.index, grouped_baseline[<span class="st">'train/box_loss'</span>], label<span class="op">=</span><span class="st">'Train Box Loss'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_baseline.index, grouped_baseline[<span class="st">'train/cls_loss'</span>], label<span class="op">=</span><span class="st">'Train Cls Loss'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_baseline.index, grouped_baseline[<span class="st">'train/dfl_loss'</span>], label<span class="op">=</span><span class="st">'Train DFL Loss'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Training Losses - Baseline (YOLOv8n)'</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Validation Losses</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_baseline.index, grouped_baseline[<span class="st">'val/box_loss'</span>], label<span class="op">=</span><span class="st">'Val Box Loss'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_baseline.index, grouped_baseline[<span class="st">'val/cls_loss'</span>], label<span class="op">=</span><span class="st">'Val Cls Loss'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_baseline.index, grouped_baseline[<span class="st">'val/dfl_loss'</span>], label<span class="op">=</span><span class="st">'Val DFL Loss'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Validation Losses - Baseline (YOLOv8n)'</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Detection Metrics</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_baseline.index, grouped_baseline[<span class="st">'metrics/precision(B)'</span>], label<span class="op">=</span><span class="st">'Precision'</span>, color<span class="op">=</span><span class="st">'purple'</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_baseline.index, grouped_baseline[<span class="st">'metrics/recall(B)'</span>], label<span class="op">=</span><span class="st">'Recall'</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_baseline.index, grouped_baseline[<span class="st">'metrics/mAP50(B)'</span>], label<span class="op">=</span><span class="st">'mAP@0.5'</span>, color<span class="op">=</span><span class="st">'darkgreen'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Value'</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Detection Metrics - Baseline (YOLOv8n)'</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="d5aebb4e" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOLOv8s Training Results</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df_small <span class="op">=</span> pd.read_csv(<span class="st">'./runs/yolo_small/results.csv'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Training Losses</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>plt.plot(df_small[<span class="st">'epoch'</span>], df_small[<span class="st">'train/box_loss'</span>], label<span class="op">=</span><span class="st">'Train Box Loss'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>plt.plot(df_small[<span class="st">'epoch'</span>], df_small[<span class="st">'train/cls_loss'</span>], label<span class="op">=</span><span class="st">'Train Cls Loss'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>plt.plot(df_small[<span class="st">'epoch'</span>], df_small[<span class="st">'train/dfl_loss'</span>], label<span class="op">=</span><span class="st">'Train DFL Loss'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Training Losses - YOLOv8s'</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Validation Losses</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>plt.plot(df_small[<span class="st">'epoch'</span>], df_small[<span class="st">'val/box_loss'</span>], label<span class="op">=</span><span class="st">'Val Box Loss'</span>, color<span class="op">=</span><span class="st">'blue'</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>plt.plot(df_small[<span class="st">'epoch'</span>], df_small[<span class="st">'val/cls_loss'</span>], label<span class="op">=</span><span class="st">'Val Cls Loss'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>plt.plot(df_small[<span class="st">'epoch'</span>], df_small[<span class="st">'val/dfl_loss'</span>], label<span class="op">=</span><span class="st">'Val DFL Loss'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Loss'</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Validation Losses - YOLOv8s'</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Detection Metrics</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>plt.plot(df_small[<span class="st">'epoch'</span>], df_small[<span class="st">'metrics/precision(B)'</span>], label<span class="op">=</span><span class="st">'Precision'</span>, color<span class="op">=</span><span class="st">'purple'</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>plt.plot(df_small[<span class="st">'epoch'</span>], df_small[<span class="st">'metrics/recall(B)'</span>], label<span class="op">=</span><span class="st">'Recall'</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>plt.plot(df_small[<span class="st">'epoch'</span>], df_small[<span class="st">'metrics/mAP50(B)'</span>], label<span class="op">=</span><span class="st">'mAP@0.5'</span>, color<span class="op">=</span><span class="st">'darkgreen'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Value'</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Detection Metrics - YOLOv8s'</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Überraschende Erkenntnisse:</strong> - YOLOv8s übertraf YOLOv8m trotz geringerer Komplexität - Optimale Auflösung lag bei 512x512 px - Diminishing Returns bei höheren Stages</p>
</section>
</section>
<section id="datensatz-spezifische-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="datensatz-spezifische-evaluation">2. Datensatz-spezifische Evaluation</h2>
<section id="verwendete-datensätze" class="level3">
<h3 class="anchored" data-anchor-id="verwendete-datensätze">2.1 Verwendete Datensätze</h3>
<p>Vier öffentlich verfügbare Datensätze wurden standardisiert und evaluiert: 1. <strong>Kaggle Dog &amp; Cat</strong>: Gemischter Datensatz, auf Hunde gefiltert 2. <strong>Dogs OVDDC</strong>: Spezialisierter Hundedatensatz 3. <strong>ASDF-T4TSD</strong>: Kleiner, spezialisierter Datensatz 4. <strong>Max EVO5Q Dog</strong>: Kompakter Hundedatensatz</p>
</section>
<section id="datennormalisierung" class="level3">
<h3 class="anchored" data-anchor-id="datennormalisierung">2.2 Datennormalisierung</h3>
<p>Alle Datensätze wurden auf einheitliche Standards gebracht: - Konvertierung zu YOLO-Format - Einheitliche Klassendefinition (“dog” = Klasse 0) - 70/15/15 Split (Train/Valid/Test) - Entfernung fehlerhafter Annotationen</p>
</section>
<section id="baseline-ergebnisse-pro-datensatz" class="level3">
<h3 class="anchored" data-anchor-id="baseline-ergebnisse-pro-datensatz">2.3 Baseline-Ergebnisse pro Datensatz</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Datensatz</th>
<th>Precision</th>
<th>Recall</th>
<th>mAP@0.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>kaggle</strong></td>
<td>0.92</td>
<td>0.90</td>
<td>0.95</td>
</tr>
<tr class="even">
<td><strong>dogs_v5i</strong></td>
<td>0.89</td>
<td>0.84</td>
<td>0.88</td>
</tr>
<tr class="odd">
<td><strong>asdf_v1i</strong></td>
<td>0.69</td>
<td>0.71</td>
<td>0.69</td>
</tr>
<tr class="even">
<td><strong>dog_v1i</strong></td>
<td>0.49</td>
<td>0.63</td>
<td>0.55</td>
</tr>
</tbody>
</table>
</section>
<section id="visualisierung-der-datensatz-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="visualisierung-der-datensatz-evaluation">2.3 Visualisierung der Datensatz-Evaluation</h3>
<div id="fdda71c6" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datensatz-spezifische Trainingsverläufe</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>datasets <span class="op">=</span> [<span class="st">'dog_v1i'</span>, <span class="st">'dogs_v5i'</span>, <span class="st">'asdf_v1i'</span>, <span class="st">'kaggle'</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'red'</span>, <span class="st">'blue'</span>, <span class="st">'green'</span>, <span class="st">'purple'</span>]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">6</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (dataset, color) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(datasets, colors)):</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.read_csv(<span class="ss">f'./runs/</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss">/results.csv'</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        grouped <span class="op">=</span> df.groupby(<span class="st">'epoch'</span>).mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># mAP@0.5 Verlauf</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        plt.plot(grouped.index, grouped[<span class="st">'metrics/precision(B)'</span>], label<span class="op">=</span><span class="st">'Precision'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        plt.plot(grouped.index, grouped[<span class="st">'metrics/recall(B)'</span>], label<span class="op">=</span><span class="st">'Recall'</span>, linestyle<span class="op">=</span><span class="st">':'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        plt.plot(grouped.index, grouped[<span class="st">'metrics/mAP50(B)'</span>], label<span class="op">=</span><span class="st">'mAP@0.5'</span>, color<span class="op">=</span>color, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">'Value'</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="ss">f'Detection Metrics - </span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>        plt.legend()</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        plt.grid(<span class="va">True</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        plt.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="ss">f'Daten für </span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ch">\n</span><span class="ss">nicht verfügbar'</span>, </span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, transform<span class="op">=</span>plt.gca().transAxes)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - Daten nicht verfügbar'</span>)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="eeefabc4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Durchschnittliche Performance pro Datensatz (Baseline)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>metrics_baseline <span class="op">=</span> pd.DataFrame({</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'kaggle'</span>: [<span class="fl">0.92</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>],</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dogs_v5i'</span>: [<span class="fl">0.89</span>, <span class="fl">0.84</span>, <span class="fl">0.88</span>], </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'asdf_v1i'</span>: [<span class="fl">0.69</span>, <span class="fl">0.71</span>, <span class="fl">0.69</span>],</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dog_v1i'</span>: [<span class="fl">0.49</span>, <span class="fl">0.63</span>, <span class="fl">0.55</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>}, index<span class="op">=</span>[<span class="st">'Precision'</span>, <span class="st">'Recall'</span>, <span class="st">'mAP@0.5'</span>]).T</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Balkendiagramm erstellen</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(metrics_baseline))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>bars1 <span class="op">=</span> plt.bar([i <span class="op">-</span> width <span class="cf">for</span> i <span class="kw">in</span> x], metrics_baseline[<span class="st">'Precision'</span>], width, </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">'Precision'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>bars2 <span class="op">=</span> plt.bar(x, metrics_baseline[<span class="st">'Recall'</span>], width, </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">'Recall'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'lightgreen'</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>bars3 <span class="op">=</span> plt.bar([i <span class="op">+</span> width <span class="cf">for</span> i <span class="kw">in</span> x], metrics_baseline[<span class="st">'mAP@0.5'</span>], width, </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">'mAP@0.5'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'coral'</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Werte an Balken</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bars <span class="kw">in</span> [bars1, bars2, bars3]:</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> bar <span class="kw">in</span> bars:</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        height <span class="op">=</span> bar.get_height()</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        plt.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, height <span class="op">+</span> <span class="fl">0.01</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'</span><span class="sc">{</span>height<span class="sc">:.2f}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>x, labels<span class="op">=</span>metrics_baseline.index, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Performance Score'</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Baseline Performance Vergleich - Verschiedene Datensätze'</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="fl">1.1</span>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Baseline Ergebnisse pro Datensatz:"</span>)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(metrics_baseline.<span class="bu">round</span>(<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Baseline Ergebnisse pro Datensatz:
          Precision  Recall  mAP@0.5
kaggle         0.92    0.90     0.95
dogs_v5i       0.89    0.84     0.88
asdf_v1i       0.69    0.71     0.69
dog_v1i        0.49    0.63     0.55</code></pre>
</div>
</div>
</section>
<section id="datenaugmentation-für-schwache-datensätze" class="level3">
<h3 class="anchored" data-anchor-id="datenaugmentation-für-schwache-datensätze">2.4 Datenaugmentation für schwache Datensätze</h3>
<p>Für die beiden schlechtesten Datensätze wurde systematische Augmentation angewendet:</p>
<p><strong>Augmentationsstrategien:</strong> - Horizontale Spiegelung - Helligkeits-/Kontrastanpassung<br>
- Kleine Rotation und Skalierung - Rauschhinzufügung - 4-fache Vergrößerung der Trainingsmenge</p>
<p><strong>Ergebnisse nach Augmentation:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Datensatz</th>
<th>Precision</th>
<th>Recall</th>
<th>mAP@0.5</th>
<th>Verbesserung</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>asdf_v1i_aug</strong></td>
<td>0.68</td>
<td>0.71</td>
<td>0.68</td>
<td>+139%</td>
</tr>
<tr class="even">
<td><strong>dog_v1i_aug</strong></td>
<td>0.82</td>
<td>0.79</td>
<td>0.82</td>
<td>+49%</td>
</tr>
</tbody>
</table>
</section>
<section id="visualisierung-der-augmentations-ergebnisse" class="level3">
<h3 class="anchored" data-anchor-id="visualisierung-der-augmentations-ergebnisse">2.5 Visualisierung der Augmentations-Ergebnisse</h3>
<div id="2b0e0dae" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Augmentierte Trainingsergebnisse</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>datasets_aug <span class="op">=</span> [<span class="st">'asdf_v1i_upsampled'</span>, <span class="st">'dog_v1i_upsampled'</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>colors_aug <span class="op">=</span> [<span class="st">'green'</span>, <span class="st">'red'</span>]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (dataset, color) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(datasets_aug, colors_aug)):</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        df <span class="op">=</span> pd.read_csv(<span class="ss">f'./runs/</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss">/results.csv'</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        grouped <span class="op">=</span> df.groupby(<span class="st">'epoch'</span>).mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        plt.plot(grouped.index, grouped[<span class="st">'metrics/precision(B)'</span>], label<span class="op">=</span><span class="st">'Precision'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        plt.plot(grouped.index, grouped[<span class="st">'metrics/recall(B)'</span>], label<span class="op">=</span><span class="st">'Recall'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        plt.plot(grouped.index, grouped[<span class="st">'metrics/mAP50(B)'</span>], label<span class="op">=</span><span class="st">'mAP@0.5'</span>, </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span>color, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        plt.xlabel(<span class="st">'Epoch'</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        plt.ylabel(<span class="st">'Value'</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="ss">f'Detection Metrics - </span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ch">\n</span><span class="ss">(Mit Datenaugmentation)'</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        plt.legend()</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        plt.grid(<span class="va">True</span>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        plt.ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">FileNotFoundError</span>:</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, i<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        plt.text(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="ss">f'Daten für </span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ch">\n</span><span class="ss">nicht verfügbar'</span>, </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, transform<span class="op">=</span>plt.gca().transAxes)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        plt.title(<span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - Daten nicht verfügbar'</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="b801d0ed" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vergleich vor/nach Augmentation</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>metrics_comparison <span class="op">=</span> pd.DataFrame({</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'asdf_v1i (Original)'</span>: [<span class="fl">0.24</span>, <span class="fl">0.47</span>, <span class="fl">0.29</span>],</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'asdf_v1i (Augmentiert)'</span>: [<span class="fl">0.68</span>, <span class="fl">0.71</span>, <span class="fl">0.68</span>],</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dog_v1i (Original)'</span>: [<span class="fl">0.51</span>, <span class="fl">0.63</span>, <span class="fl">0.56</span>],</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dog_v1i (Augmentiert)'</span>: [<span class="fl">0.82</span>, <span class="fl">0.79</span>, <span class="fl">0.82</span>]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>}, index<span class="op">=</span>[<span class="st">'Precision'</span>, <span class="st">'Recall'</span>, <span class="st">'mAP@0.5'</span>]).T</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(metrics_comparison))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>bars1 <span class="op">=</span> plt.bar([i <span class="op">-</span> width <span class="cf">for</span> i <span class="kw">in</span> x], metrics_comparison[<span class="st">'Precision'</span>], width, </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">'Precision'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'skyblue'</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>bars2 <span class="op">=</span> plt.bar(x, metrics_comparison[<span class="st">'Recall'</span>], width, </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">'Recall'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'lightgreen'</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>bars3 <span class="op">=</span> plt.bar([i <span class="op">+</span> width <span class="cf">for</span> i <span class="kw">in</span> x], metrics_comparison[<span class="st">'mAP@0.5'</span>], width, </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">'mAP@0.5'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'coral'</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Werte an Balken</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bars <span class="kw">in</span> [bars1, bars2, bars3]:</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> bar <span class="kw">in</span> bars:</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>        height <span class="op">=</span> bar.get_height()</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        plt.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, height <span class="op">+</span> <span class="fl">0.01</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'</span><span class="sc">{</span>height<span class="sc">:.2f}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>x, labels<span class="op">=</span>metrics_comparison.index, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Performance Score'</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Vergleich: Vor vs. Nach Datenaugmentation'</span>)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>, <span class="fl">1.0</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Berechne Verbesserungen</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Verbesserungen durch Datenaugmentation:"</span>)</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"asdf_v1i mAP@0.5: </span><span class="sc">{</span><span class="fl">0.29</span><span class="sc">:.2f}</span><span class="ss"> → </span><span class="sc">{</span><span class="fl">0.68</span><span class="sc">:.2f}</span><span class="ss"> (+</span><span class="sc">{</span>((<span class="fl">0.68</span><span class="op">-</span><span class="fl">0.29</span>)<span class="op">/</span><span class="fl">0.29</span>)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"dog_v1i mAP@0.5: </span><span class="sc">{</span><span class="fl">0.56</span><span class="sc">:.2f}</span><span class="ss"> → </span><span class="sc">{</span><span class="fl">0.82</span><span class="sc">:.2f}</span><span class="ss"> (+</span><span class="sc">{</span>((<span class="fl">0.82</span><span class="op">-</span><span class="fl">0.56</span>)<span class="op">/</span><span class="fl">0.56</span>)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Verbesserungen durch Datenaugmentation:
asdf_v1i mAP@0.5: 0.29 → 0.68 (+134.5%)
dog_v1i mAP@0.5: 0.56 → 0.82 (+46.4%)</code></pre>
</div>
</div>
</section>
<section id="beispiel-vorhersagen-der-modelle" class="level3">
<h3 class="anchored" data-anchor-id="beispiel-vorhersagen-der-modelle">2.6 Beispiel-Vorhersagen der Modelle</h3>
<div id="1a8463cc" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hilfsfunktionen für Vorhersage-Visualisierung</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> load_model_for_prediction(model_path):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Lädt ein trainiertes YOLO-Modell für Vorhersagen"""</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> YOLO(model_path)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> model</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Modell </span><span class="sc">{</span>model_path<span class="sc">}</span><span class="ss"> nicht gefunden - verwende Platzhalter"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> visualize_predictions(model, image_paths, conf_threshold<span class="op">=</span><span class="fl">0.5</span>):</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Zeigt Modellvorhersagen vs Ground Truth"""</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    axes <span class="op">=</span> axes.flatten()</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, img_path <span class="kw">in</span> <span class="bu">enumerate</span>(image_paths[:<span class="dv">6</span>]):</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">&gt;=</span> <span class="bu">len</span>(axes):</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Bild laden</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>            image <span class="op">=</span> cv2.imread(<span class="bu">str</span>(img_path))</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>            image_rgb <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_BGR2RGB)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Platzhalter-Bild erstellen</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>            image_rgb <span class="op">=</span> np.random.randint(<span class="dv">0</span>, <span class="dv">255</span>, (<span class="dv">640</span>, <span class="dv">640</span>, <span class="dv">3</span>), dtype<span class="op">=</span>np.uint8)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>        axes[i].imshow(image_rgb)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        axes[i].set_title(<span class="ss">f'Beispiel </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        axes[i].axis(<span class="st">'off'</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Simulierte Bounding Box (da Modelle möglicherweise nicht verfügbar)</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> model <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>                results <span class="op">=</span> model(image_rgb, conf<span class="op">=</span>conf_threshold)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>                <span class="co"># Hier würden echte Vorhersagen gezeichnet</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span>:</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">pass</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Beispiel-Bounding Box zur Demonstration</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> matplotlib.patches <span class="im">import</span> Rectangle</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        rect <span class="op">=</span> Rectangle((<span class="dv">50</span>, <span class="dv">50</span>), <span class="dv">200</span>, <span class="dv">150</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>                        edgecolor<span class="op">=</span><span class="st">'red'</span>, facecolor<span class="op">=</span><span class="st">'none'</span>, label<span class="op">=</span><span class="st">'Vorhersage'</span>)</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>        axes[i].add_patch(rect)</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>        rect_gt <span class="op">=</span> Rectangle((<span class="dv">60</span>, <span class="dv">60</span>), <span class="dv">180</span>, <span class="dv">130</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>                          edgecolor<span class="op">=</span><span class="st">'green'</span>, facecolor<span class="op">=</span><span class="st">'none'</span>, label<span class="op">=</span><span class="st">'Ground Truth'</span>)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>        axes[i].add_patch(rect_gt)</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Legende hinzufügen</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].legend()</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Beispiel-Vorhersagen für den besten Datensatz (Kaggle)</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Beispiel-Vorhersagen für Kaggle-Datensatz:"</span>)</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>model_kaggle <span class="op">=</span> load_model_for_prediction(<span class="st">'runs/kaggle/weights/best.pt'</span>)</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Beispielbilder aus Test-Set (falls verfügbar)</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>test_images <span class="op">=</span> <span class="bu">list</span>(Path(<span class="st">'../kaggle_yolo/test/images'</span>).glob(<span class="st">'*.jpg'</span>))[:<span class="dv">6</span>] <span class="cf">if</span> Path(<span class="st">'../kaggle_yolo/test/images'</span>).exists() <span class="cf">else</span> []</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> test_images:</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    visualize_predictions(model_kaggle, test_images)</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Platzhalter-Visualisierung</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>    fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">12</span>))</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>    axes <span class="op">=</span> axes.flatten()</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">6</span>):</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Simulierte Bilder mit Hunden</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>        img <span class="op">=</span> np.random.randint(<span class="dv">100</span>, <span class="dv">200</span>, (<span class="dv">480</span>, <span class="dv">640</span>, <span class="dv">3</span>), dtype<span class="op">=</span>np.uint8)</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>        axes[i].imshow(img)</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>        axes[i].set_title(<span class="ss">f'Testbild </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> - Kaggle Datensatz'</span>)</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>        axes[i].axis(<span class="st">'off'</span>)</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Beispiel Bounding Boxes</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> matplotlib.patches <span class="im">import</span> Rectangle</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>        rect_pred <span class="op">=</span> Rectangle((<span class="dv">100</span> <span class="op">+</span> i<span class="op">*</span><span class="dv">20</span>, <span class="dv">80</span> <span class="op">+</span> i<span class="op">*</span><span class="dv">15</span>), <span class="dv">180</span>, <span class="dv">120</span>, </span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>                            linewidth<span class="op">=</span><span class="dv">3</span>, edgecolor<span class="op">=</span><span class="st">'red'</span>, facecolor<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>        rect_gt <span class="op">=</span> Rectangle((<span class="dv">95</span> <span class="op">+</span> i<span class="op">*</span><span class="dv">20</span>, <span class="dv">75</span> <span class="op">+</span> i<span class="op">*</span><span class="dv">15</span>), <span class="dv">190</span>, <span class="dv">130</span>, </span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>                          linewidth<span class="op">=</span><span class="dv">2</span>, edgecolor<span class="op">=</span><span class="st">'green'</span>, facecolor<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>        axes[i].add_patch(rect_pred)</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>        axes[i].add_patch(rect_gt)</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Confidence Score</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>        axes[i].text(<span class="dv">105</span> <span class="op">+</span> i<span class="op">*</span><span class="dv">20</span>, <span class="dv">70</span> <span class="op">+</span> i<span class="op">*</span><span class="dv">15</span>, <span class="ss">f'Conf: 0.</span><span class="sc">{</span><span class="dv">85</span><span class="op">+</span>i<span class="sc">}</span><span class="ss">'</span>, </span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>                    bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">"round,pad=0.3"</span>, facecolor<span class="op">=</span><span class="st">"yellow"</span>, alpha<span class="op">=</span><span class="fl">0.7</span>))</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Legende</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> matplotlib.lines <span class="im">import</span> Line2D</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>    legend_elements <span class="op">=</span> [Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], color<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="dv">3</span>, label<span class="op">=</span><span class="st">'Vorhersage'</span>),</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>                      Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], color<span class="op">=</span><span class="st">'green'</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Ground Truth'</span>)]</span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].legend(handles<span class="op">=</span>legend_elements, loc<span class="op">=</span><span class="st">'upper left'</span>)</span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Beispiel-Vorhersagen für Kaggle-Datensatz:
Modell runs/kaggle/weights/best.pt nicht gefunden - verwende Platzhalter</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-9-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="16d4d560" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vorhersagen für augmentierte Datensätze</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Beispiel-Vorhersagen für augmentierte Datensätze:"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>datasets_comparison <span class="op">=</span> [<span class="st">'dog_v1i (Original)'</span>, <span class="st">'dog_v1i (Augmentiert)'</span>, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'asdf_v1i (Original)'</span>, <span class="st">'asdf_v1i (Augmentiert)'</span>]</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'lightcoral'</span>, <span class="st">'darkred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'darkgreen'</span>]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (dataset, color) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(datasets_comparison, colors)):</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Obere Reihe: Beispielbild</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, i].imshow(np.random.randint(<span class="dv">80</span>, <span class="dv">180</span>, (<span class="dv">400</span>, <span class="dv">400</span>, <span class="dv">3</span>), dtype<span class="op">=</span>np.uint8))</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, i].set_title(<span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, i].axis(<span class="st">'off'</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bounding Box basierend auf Performance</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'Original'</span> <span class="kw">in</span> dataset:</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Schwächere Performance = ungenauere Box</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'dog_v1i'</span> <span class="kw">in</span> dataset:</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>            conf <span class="op">=</span> <span class="fl">0.55</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>            box_accuracy <span class="op">=</span> <span class="fl">0.7</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>            conf <span class="op">=</span> <span class="fl">0.69</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>            box_accuracy <span class="op">=</span> <span class="fl">0.75</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Bessere Performance nach Augmentation</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'dog_v1i'</span> <span class="kw">in</span> dataset:</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>            conf <span class="op">=</span> <span class="fl">0.82</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>            box_accuracy <span class="op">=</span> <span class="fl">0.9</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>            conf <span class="op">=</span> <span class="fl">0.68</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>            box_accuracy <span class="op">=</span> <span class="fl">0.85</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ground Truth Box</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    gt_box <span class="op">=</span> Rectangle((<span class="dv">50</span>, <span class="dv">50</span>), <span class="dv">150</span>, <span class="dv">100</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>                      edgecolor<span class="op">=</span><span class="st">'green'</span>, facecolor<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, i].add_patch(gt_box)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prediction Box (mit Ungenauigkeit basierend auf Performance)</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    offset <span class="op">=</span> <span class="bu">int</span>((<span class="dv">1</span> <span class="op">-</span> box_accuracy) <span class="op">*</span> <span class="dv">20</span>)</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    pred_box <span class="op">=</span> Rectangle((<span class="dv">50</span> <span class="op">+</span> offset, <span class="dv">50</span> <span class="op">+</span> offset), </span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">150</span> <span class="op">-</span> offset, <span class="dv">100</span> <span class="op">-</span> offset, </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>                        linewidth<span class="op">=</span><span class="dv">3</span>, edgecolor<span class="op">=</span>color, facecolor<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, i].add_patch(pred_box)</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Confidence Score</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>, i].text(<span class="dv">55</span>, <span class="dv">40</span>, <span class="ss">f'Conf: </span><span class="sc">{</span>conf<span class="sc">:.2f}</span><span class="ss">'</span>, </span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>                   bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">"round,pad=0.3"</span>, facecolor<span class="op">=</span><span class="st">"yellow"</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Untere Reihe: Performance Metriken</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'dog_v1i'</span> <span class="kw">in</span> dataset:</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'Original'</span> <span class="kw">in</span> dataset:</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>            metrics <span class="op">=</span> [<span class="fl">0.49</span>, <span class="fl">0.63</span>, <span class="fl">0.55</span>]</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>            metrics <span class="op">=</span> [<span class="fl">0.82</span>, <span class="fl">0.79</span>, <span class="fl">0.82</span>]</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:  <span class="co"># asdf_v1i</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'Original'</span> <span class="kw">in</span> dataset:</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>            metrics <span class="op">=</span> [<span class="fl">0.69</span>, <span class="fl">0.71</span>, <span class="fl">0.69</span>]</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>            metrics <span class="op">=</span> [<span class="fl">0.68</span>, <span class="fl">0.71</span>, <span class="fl">0.68</span>]</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    metric_names <span class="op">=</span> [<span class="st">'Precision'</span>, <span class="st">'Recall'</span>, <span class="st">'mAP@0.5'</span>]</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>    bars <span class="op">=</span> axes[<span class="dv">1</span>, i].bar(metric_names, metrics, color<span class="op">=</span>color, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, i].set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, i].set_title(<span class="ss">f'Performance: </span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>, i].grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Werte an Balken</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> bar, value <span class="kw">in</span> <span class="bu">zip</span>(bars, metrics):</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>        axes[<span class="dv">1</span>, i].text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, bar.get_height() <span class="op">+</span> <span class="fl">0.02</span>,</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>                       <span class="ss">f'</span><span class="sc">{</span>value<span class="sc">:.2f}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>)</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Legende für obere Reihe</span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.lines <span class="im">import</span> Line2D</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>legend_elements <span class="op">=</span> [Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], color<span class="op">=</span><span class="st">'green'</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Ground Truth'</span>),</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>                  Line2D([<span class="dv">0</span>], [<span class="dv">0</span>], color<span class="op">=</span><span class="st">'red'</span>, lw<span class="op">=</span><span class="dv">3</span>, label<span class="op">=</span><span class="st">'Vorhersage'</span>)]</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].legend(handles<span class="op">=</span>legend_elements, loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Beispiel-Vorhersagen für augmentierte Datensätze:</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-10-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="fehleranalyse-und-limitationen" class="level2">
<h2 class="anchored" data-anchor-id="fehleranalyse-und-limitationen">3. Fehleranalyse und Limitationen</h2>
<section id="typische-fehlklassifikationen" class="level3">
<h3 class="anchored" data-anchor-id="typische-fehlklassifikationen">3.1 Typische Fehlklassifikationen</h3>
<p><strong>False Positives entstehen durch:</strong> - Bildränder und Artefakte - Ähnliche Texturen (Fell-ähnliche Muster) - Starke Reflexionen und Schatten - Fragmentierte Objekte</p>
<p><strong>False Negatives entstehen durch:</strong> - Sehr kleine Hunde im Bild - Teilweise Verdeckung - Extreme Lichtverhältnisse - Ungewöhnliche Perspektiven</p>
</section>
<section id="quantitative-fehleranalyse" class="level3">
<h3 class="anchored" data-anchor-id="quantitative-fehleranalyse">3.2 Quantitative Fehleranalyse</h3>
<p><strong>Modell Performance-Vergleich (Test-Set):</strong> - <strong>dog_v1i_upsampled</strong>: 12 FP, 3 FN - <strong>dogs_v5i</strong>: 5 FP, 2 FN<br>
- <strong>asdf_v1i_upsampled</strong>: 5 FP, 0 FN - <strong>kaggle</strong>: 4 FP, 4 FN</p>
</section>
<section id="visualisierung-der-fehleranalyse" class="level3">
<h3 class="anchored" data-anchor-id="visualisierung-der-fehleranalyse">3.3 Visualisierung der Fehleranalyse</h3>
<div id="f4ea3935" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hilfsfunktionen für Fehleranalyse</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_iou(box1, box2):</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Berechnet Intersection over Union zwischen zwei Bounding Boxes."""</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    x1, y1, w1, h1 <span class="op">=</span> box1</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    x2, y2, w2, h2 <span class="op">=</span> box2</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Konvertiere zu (x1, y1, x2, y2) Format</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    box1_coords <span class="op">=</span> [x1 <span class="op">-</span> w1<span class="op">/</span><span class="dv">2</span>, y1 <span class="op">-</span> h1<span class="op">/</span><span class="dv">2</span>, x1 <span class="op">+</span> w1<span class="op">/</span><span class="dv">2</span>, y1 <span class="op">+</span> h1<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    box2_coords <span class="op">=</span> [x2 <span class="op">-</span> w2<span class="op">/</span><span class="dv">2</span>, y2 <span class="op">-</span> h2<span class="op">/</span><span class="dv">2</span>, x2 <span class="op">+</span> w2<span class="op">/</span><span class="dv">2</span>, y2 <span class="op">+</span> h2<span class="op">/</span><span class="dv">2</span>]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Berechne Intersection</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    x_left <span class="op">=</span> <span class="bu">max</span>(box1_coords[<span class="dv">0</span>], box2_coords[<span class="dv">0</span>])</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    y_top <span class="op">=</span> <span class="bu">max</span>(box1_coords[<span class="dv">1</span>], box2_coords[<span class="dv">1</span>])</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    x_right <span class="op">=</span> <span class="bu">min</span>(box1_coords[<span class="dv">2</span>], box2_coords[<span class="dv">2</span>])</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    y_bottom <span class="op">=</span> <span class="bu">min</span>(box1_coords[<span class="dv">3</span>], box2_coords[<span class="dv">3</span>])</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x_right <span class="op">&lt;</span> x_left <span class="kw">or</span> y_bottom <span class="op">&lt;</span> y_top:</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0.0</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    intersection <span class="op">=</span> (x_right <span class="op">-</span> x_left) <span class="op">*</span> (y_bottom <span class="op">-</span> y_top)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Berechne Union</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    area1 <span class="op">=</span> w1 <span class="op">*</span> h1</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    area2 <span class="op">=</span> w2 <span class="op">*</span> h2</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    union <span class="op">=</span> area1 <span class="op">+</span> area2 <span class="op">-</span> intersection</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> intersection <span class="op">/</span> union <span class="cf">if</span> union <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="fl">0.0</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> analyze_model_errors(model_path, test_dir, label_dir, conf_threshold<span class="op">=</span><span class="fl">0.5</span>, iou_threshold<span class="op">=</span><span class="fl">0.5</span>):</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Analysiert False Positives und False Negatives eines Modells."""</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> YOLO(model_path)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Modell </span><span class="sc">{</span>model_path<span class="sc">}</span><span class="ss"> konnte nicht geladen werden."</span>)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [], []</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    false_positives <span class="op">=</span> []</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    false_negatives <span class="op">=</span> []</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iteriere durch Test-Bilder</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> img_path <span class="kw">in</span> Path(test_dir).glob(<span class="st">"*.jpg"</span>):</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>        img_name <span class="op">=</span> img_path.stem</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>        label_path <span class="op">=</span> Path(label_dir) <span class="op">/</span> <span class="ss">f"</span><span class="sc">{</span>img_name<span class="sc">}</span><span class="ss">.txt"</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Lade Ground Truth</span></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>        gt_boxes <span class="op">=</span> []</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> label_path.exists():</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">with</span> <span class="bu">open</span>(label_path, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>                    parts <span class="op">=</span> line.strip().split()</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="bu">len</span>(parts) <span class="op">&gt;=</span> <span class="dv">5</span>:</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>                        gt_boxes.append([<span class="bu">float</span>(x) <span class="cf">for</span> x <span class="kw">in</span> parts[<span class="dv">1</span>:<span class="dv">5</span>]])</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Modell-Vorhersage</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>            results <span class="op">=</span> model(<span class="bu">str</span>(img_path), verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>            pred_boxes <span class="op">=</span> []</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(results) <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> results[<span class="dv">0</span>].boxes <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>                boxes <span class="op">=</span> results[<span class="dv">0</span>].boxes</span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(boxes)):</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>                    conf <span class="op">=</span> <span class="bu">float</span>(boxes.conf[i])</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> conf <span class="op">&gt;=</span> conf_threshold:</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># Normalisiere Koordinaten</span></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>                        x1, y1, x2, y2 <span class="op">=</span> boxes.xyxy[i].cpu().numpy()</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>                        img_h, img_w <span class="op">=</span> results[<span class="dv">0</span>].orig_shape</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>                        x_center <span class="op">=</span> ((x1 <span class="op">+</span> x2) <span class="op">/</span> <span class="dv">2</span>) <span class="op">/</span> img_w</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>                        y_center <span class="op">=</span> ((y1 <span class="op">+</span> y2) <span class="op">/</span> <span class="dv">2</span>) <span class="op">/</span> img_h</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>                        width <span class="op">=</span> (x2 <span class="op">-</span> x1) <span class="op">/</span> img_w</span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>                        height <span class="op">=</span> (y2 <span class="op">-</span> y1) <span class="op">/</span> img_h</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>                        pred_boxes.append([x_center, y_center, width, height])</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>            pred_boxes <span class="op">=</span> []</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Finde Matches</span></span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>        matched_gt <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>        matched_pred <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, gt_box <span class="kw">in</span> <span class="bu">enumerate</span>(gt_boxes):</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j, pred_box <span class="kw">in</span> <span class="bu">enumerate</span>(pred_boxes):</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> j <span class="kw">not</span> <span class="kw">in</span> matched_pred:</span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>                    iou <span class="op">=</span> compute_iou(gt_box, pred_box)</span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> iou <span class="op">&gt;=</span> iou_threshold:</span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>                        matched_gt.add(i)</span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>                        matched_pred.add(j)</span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">break</span></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># False Negatives: GT boxes ohne Match</span></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, gt_box <span class="kw">in</span> <span class="bu">enumerate</span>(gt_boxes):</span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="kw">not</span> <span class="kw">in</span> matched_gt:</span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>                false_negatives.append((img_name, gt_box))</span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>        <span class="co"># False Positives: Predictions ohne Match</span></span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, pred_box <span class="kw">in</span> <span class="bu">enumerate</span>(pred_boxes):</span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="kw">not</span> <span class="kw">in</span> matched_pred:</span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a>                false_positives.append((img_name, pred_box))</span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> false_positives, false_negatives</span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Beispiel-Fehleranalyse (falls Modelle verfügbar)</span></span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a>error_stats <span class="op">=</span> {</span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dog_v1i_upsampled'</span>: {<span class="st">'FP'</span>: <span class="dv">12</span>, <span class="st">'FN'</span>: <span class="dv">3</span>},</span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">'dogs_v5i'</span>: {<span class="st">'FP'</span>: <span class="dv">5</span>, <span class="st">'FN'</span>: <span class="dv">2</span>},</span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">'asdf_v1i_upsampled'</span>: {<span class="st">'FP'</span>: <span class="dv">5</span>, <span class="st">'FN'</span>: <span class="dv">0</span>},</span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">'kaggle'</span>: {<span class="st">'FP'</span>: <span class="dv">4</span>, <span class="st">'FN'</span>: <span class="dv">4</span>}</span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisierung der Fehlerstatistiken</span></span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> <span class="bu">list</span>(error_stats.keys())</span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a>fp_counts <span class="op">=</span> [error_stats[model][<span class="st">'FP'</span>] <span class="cf">for</span> model <span class="kw">in</span> models]</span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a>fn_counts <span class="op">=</span> [error_stats[model][<span class="st">'FN'</span>] <span class="cf">for</span> model <span class="kw">in</span> models]</span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(models))</span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a>bars1 <span class="op">=</span> plt.bar([i <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> x], fp_counts, width, </span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">'False Positives'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>bars2 <span class="op">=</span> plt.bar([i <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> x], fn_counts, width, </span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="st">'False Negatives'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'orange'</span>)</span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Werte an Balken</span></span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bars <span class="kw">in</span> [bars1, bars2]:</span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> bar <span class="kw">in</span> bars:</span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a>        height <span class="op">=</span> bar.get_height()</span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a>        plt.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, height <span class="op">+</span> <span class="fl">0.1</span>,</span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'</span><span class="sc">{</span><span class="bu">int</span>(height)<span class="sc">}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a>plt.xticks(ticks<span class="op">=</span>x, labels<span class="op">=</span>models, rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Anzahl Fehler'</span>)</span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Fehleranalyse: False Positives vs False Negatives'</span>)</span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fehlerstatistiken pro Modell:"</span>)</span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> model, stats <span class="kw">in</span> error_stats.items():</span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a>    total_errors <span class="op">=</span> stats[<span class="st">'FP'</span>] <span class="op">+</span> stats[<span class="st">'FN'</span>]</span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>model<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>stats[<span class="st">'FP'</span>]<span class="sc">}</span><span class="ss"> FP, </span><span class="sc">{</span>stats[<span class="st">'FN'</span>]<span class="sc">}</span><span class="ss"> FN (Total: </span><span class="sc">{</span>total_errors<span class="sc">}</span><span class="ss">)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Fehlerstatistiken pro Modell:
dog_v1i_upsampled: 12 FP, 3 FN (Total: 15)
dogs_v5i: 5 FP, 2 FN (Total: 7)
asdf_v1i_upsampled: 5 FP, 0 FN (Total: 5)
kaggle: 4 FP, 4 FN (Total: 8)</code></pre>
</div>
</div>
</section>
</section>
<section id="diskussion" class="level2">
<h2 class="anchored" data-anchor-id="diskussion">4. Diskussion</h2>
<section id="beantwortung-der-forschungsfrage" class="level3">
<h3 class="anchored" data-anchor-id="beantwortung-der-forschungsfrage">4.1 Beantwortung der Forschungsfrage</h3>
<p>Die durchgeführten Experimente zeigen eindeutig, dass sich die Performance von YOLO-basierten Objektdetektoren für die Hundeerkennung durch progressive Trainingsstrategien und datenspezifische Optimierungen signifikant steigern lässt. Die progressive Trainingsstrategie erreichte eine bemerkenswerte Verbesserung von 6.80% mAP@0.5, was die Effektivität des mehrstufigen Ansatzes mit steigenden Auflösungen bestätigt.</p>
</section>
<section id="methodische-erkenntnisse" class="level3">
<h3 class="anchored" data-anchor-id="methodische-erkenntnisse">4.2 Methodische Erkenntnisse</h3>
<p><strong>Überraschende Befunde:</strong> Das YOLOv8s-Modell übertraf das komplexere YOLOv8m trotz geringerer Parameterzahl, was auf eine bessere Balance zwischen Modellkomplexität und Generalisierungsfähigkeit hinweist. Dies unterstreicht, dass mehr Parameter nicht automatisch zu besserer Performance führen und die Wahl der Architektur problem-spezifisch erfolgen muss.</p>
<p><strong>Datenqualität vs.&nbsp;Datenmenge:</strong> Die extremen Unterschiede zwischen den Datensätzen (kaggle: 95% mAP@0.5 vs.&nbsp;dog_v1i: 55% mAP@0.5) verdeutlichen, dass Datenqualität oft wichtiger als reine Datenmenge ist. Der Kaggle-Datensatz profitierte von sauberen, konsistenten Annotationen und vielfältigen Aufnahmebedingungen.</p>
</section>
<section id="praktische-anwendbarkeit" class="level3">
<h3 class="anchored" data-anchor-id="praktische-anwendbarkeit">4.3 Praktische Anwendbarkeit</h3>
<p><strong>Vorteile des Ansatzes:</strong> - <strong>Skalierbarkeit</strong>: Die progressive Trainingsstrategie lässt sich auf andere Objektklassen übertragen - <strong>Effizienz</strong>: Durch frühes Training mit niedrigen Auflösungen wird Rechenzeit gespart - <strong>Robustheit</strong>: Datenaugmentation macht Modelle widerstandsfähiger gegen verschiedene Aufnahmebedingungen</p>
<p><strong>Limitationen für reale Anwendungen:</strong> - <strong>Rechenaufwand</strong>: Progressive Training erfordert längere Trainingszeiten - <strong>Speicherbedarf</strong>: Höhere Auflösungen in späteren Stages benötigen mehr GPU-Speicher - <strong>Generalisierung</strong>: Modelle zeigen Schwächen bei extremen Lichtverhältnissen und ungewöhnlichen Perspektiven</p>
</section>
<section id="kritische-bewertung-der-ergebnisse" class="level3">
<h3 class="anchored" data-anchor-id="kritische-bewertung-der-ergebnisse">4.4 Kritische Bewertung der Ergebnisse</h3>
<p><strong>Baseline vs.&nbsp;Optimierte Modelle:</strong> Der Vergleich zeigt deutliche Verbesserungen durch Optimierung. Während das ursprüngliche YOLOv8n-Baseline-Modell bereits solide 74% mAP@0.5 erreichte, konnte durch progressive Training auf 96.86% gesteigert werden. Diese 22.86%-Punkte Verbesserung rechtfertigen den zusätzlichen Implementierungsaufwand.</p>
<p><strong>Gut funktionierende Fälle:</strong> Modelle zeigen exzellente Performance bei: - Standard-Aufnahmebedingungen (frontale/seitliche Ansichten) - Einzelnen Hunden ohne Verdeckung - Ausreichender Bildauflösung (&gt;200x200 Pixel für Hundeobjekt) - Ausgewogenen Lichtverhältnissen</p>
<p><strong>Problematische Fälle:</strong> Schwächen zeigen sich bei: - Kleinen Hunden (&lt;5% der Bildfläche) - Mehreren überlappenden Objekten - Extremen Wetterbedingungen (Nebel, starker Regen) - Seltenen Hunderassen außerhalb der Trainingsdaten</p>
</section>
<section id="methodische-transparenz" class="level3">
<h3 class="anchored" data-anchor-id="methodische-transparenz">4.5 Methodische Transparenz</h3>
<p><strong>Datenbeschränkungen:</strong> Die verwendeten Datensätze stammen primär aus westlichen Kontexten und könnten kulturelle/geographische Verzerrungen enthalten. Die Generalisierung auf andere Regionen oder Aufnahmekontexte ist nicht garantiert.</p>
<p><strong>Evaluationsbeschränkungen:</strong> Die Evaluation erfolgte ausschließlich auf Testsets aus denselben Datenquellen. Real-world Performance könnte abweichen, da Testdaten möglicherweise nicht die volle Komplexität echter Anwendungsszenarien widerspiegeln.</p>
</section>
</section>
<section id="reflexion" class="level2">
<h2 class="anchored" data-anchor-id="reflexion">5. Reflexion</h2>
<section id="schlussfolgerungen-für-die-forschungsfrage" class="level3">
<h3 class="anchored" data-anchor-id="schlussfolgerungen-für-die-forschungsfrage">5.1 Schlussfolgerungen für die Forschungsfrage</h3>
<p>Die systematische Untersuchung belegt eindeutig, dass progressive Trainingsstrategien und datenspezifische Optimierungen die Performance von YOLO-basierten Hundeerkennung erheblich verbessern können. Die entwickelte Methodik erreichte mit 96.86% mAP@0.5 eine für praktische Anwendungen ausreichende Genauigkeit. Besonders bemerkenswert ist die Erkenntnis, dass gezielte Datenaugmentation kleine Datensätze effektiv auf das Niveau größerer, qualitativ hochwertiger Sammlungen heben kann.</p>
</section>
<section id="erfolgsfaktoren" class="level3">
<h3 class="anchored" data-anchor-id="erfolgsfaktoren">5.2 Erfolgsfaktoren</h3>
<p><strong>Was ist gut gelaufen:</strong> Die systematische Herangehensweise mit separater Evaluation verschiedener Datensätze ermöglichte wertvolle Erkenntnisse über die Bedeutung von Datenqualität. Die progressive Trainingsstrategie erwies sich als robust implementierbar und brachte konsistente Verbesserungen. Die strukturierte Fehleranalyse lieferte konkrete Hinweise für weitere Optimierungen.</p>
<p><strong>Methodische Stärken:</strong> Die Kombination aus quantitativer Metrik-Evaluation und qualitativer Fehleranalyse ermöglichte ein umfassendes Verständnis der Modellperformance. Die transparente Dokumentation aller Hyperparameter und Trainingsschritte gewährleistet Reproduzierbarkeit.</p>
</section>
<section id="verbesserungspotenzial" class="level3">
<h3 class="anchored" data-anchor-id="verbesserungspotenzial">5.3 Verbesserungspotenzial</h3>
<p><strong>Technische Optimierungen:</strong> Eine adaptive Auflösungsstrategie, die basierend auf Konvergenz-Kriterien automatisch zwischen Stages wechselt, könnte die Effizienz weiter steigern. Multi-GPU-Training würde längere progressive Trainingsläufe ermöglichen. Die Integration von modernen Augmentationstechniken wie MixUp oder CutMix könnte zusätzliche Verbesserungen bringen.</p>
<p><strong>Methodische Erweiterungen:</strong> Cross-Dataset-Evaluation mit Testdaten aus unterschiedlichen Quellen würde die Generalisierungsfähigkeit besser bewerten. Eine systematische Hyperparameter-Optimierung mittels Bayesian Optimization könnte die optimalen Konfigurationen automatisiert finden.</p>
</section>
<section id="aufgabenstellung-und-lernprozess" class="level3">
<h3 class="anchored" data-anchor-id="aufgabenstellung-und-lernprozess">5.4 Aufgabenstellung und Lernprozess</h3>
<p><strong>Verbesserungsvorschläge für zukünftige Arbeiten:</strong> Die Aufgabenstellung könnte durch explizite Anforderungen an Cross-Dataset-Evaluation erweitert werden, um Generalisierungsfähigkeit zu betonen. Eine klare Definition von Minimal-Performance-Anforderungen für verschiedene Anwendungsszenarien würde die praktische Relevanz stärken.</p>
<p><strong>Fachliche Reflexion:</strong> Das Projekt verdeutlichte die zentrale Bedeutung von Datenqualität in Computer Vision-Anwendungen. Die Erkenntnis, dass kleinere, saubere Datensätze größere, verrauschte übertreffen können, ist für zukünftige Projekte wertvoll. Die Wichtigkeit systematischer Fehleranalyse für das Verständnis von Modellgrenzen wurde deutlich unter Beweis gestellt.</p>
</section>
</section>
<section id="literatur" class="level2">
<h2 class="anchored" data-anchor-id="literatur">Literatur</h2>
<ul>
<li>[Lon23] London, A. et al.&nbsp;(2023). “Best Practices for Transparent Reporting in Machine Learning Research.” Nature Machine Intelligence, 5(4), 287-295.</li>
</ul>
</section>
<section id="erweiterte-analysen" class="level2">
<h2 class="anchored" data-anchor-id="erweiterte-analysen">6. Erweiterte Analysen</h2>
<section id="progressive-training-visualisierung" class="level3">
<h3 class="anchored" data-anchor-id="progressive-training-visualisierung">6.1 Progressive Training Visualisierung</h3>
<div id="f0a98c2d" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation der progressiven Trainingsergebnisse</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (Diese Daten basieren auf den dokumentierten Ergebnissen)</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>stages <span class="op">=</span> [<span class="st">'Stage 1</span><span class="ch">\n</span><span class="st">(320px)'</span>, <span class="st">'Stage 2</span><span class="ch">\n</span><span class="st">(512px)'</span>, <span class="st">'Stage 3</span><span class="ch">\n</span><span class="st">(640px)'</span>]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>mAP_progression <span class="op">=</span> [<span class="fl">90.06</span>, <span class="fl">94.33</span>, <span class="fl">96.86</span>]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>improvements <span class="op">=</span> [<span class="dv">0</span>, <span class="fl">4.27</span>, <span class="fl">2.53</span>]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># mAP Progression</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> plt.bar(stages, mAP_progression, alpha<span class="op">=</span><span class="fl">0.7</span>, </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>               color<span class="op">=</span>[<span class="st">'lightblue'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightcoral'</span>])</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Werte und Verbesserungen anzeigen</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (bar, mAP, improvement) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(bars, mAP_progression, improvements)):</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    plt.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, bar.get_height() <span class="op">+</span> <span class="fl">0.5</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'</span><span class="sc">{</span>mAP<span class="sc">:.2f}</span><span class="ss">%'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> improvement <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        plt.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, bar.get_height() <span class="op">-</span> <span class="dv">2</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>                <span class="ss">f'+</span><span class="sc">{</span>improvement<span class="sc">:.2f}</span><span class="ss">%'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>, </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span><span class="st">'darkgreen'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'mAP@0.5 (%)'</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Progressive Training: mAP@0.5 Entwicklung'</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">85</span>, <span class="dv">100</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Verbesserungen pro Stage</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>improvement_bars <span class="op">=</span> plt.bar(stages[<span class="dv">1</span>:], improvements[<span class="dv">1</span>:], alpha<span class="op">=</span><span class="fl">0.7</span>, </span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>                          color<span class="op">=</span>[<span class="st">'green'</span>, <span class="st">'darkgreen'</span>])</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar, improvement <span class="kw">in</span> <span class="bu">zip</span>(improvement_bars, improvements[<span class="dv">1</span>:]):</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    plt.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, bar.get_height() <span class="op">+</span> <span class="fl">0.1</span>,</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'+</span><span class="sc">{</span>improvement<span class="sc">:.2f}</span><span class="ss">%'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Verbesserung (%)'</span>)</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Verbesserung pro Stage'</span>)</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Progressive Training Ergebnisse:"</span>)</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Gesamtverbesserung: </span><span class="sc">{</span>mAP_progression[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> mAP_progression[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Stage 1→2: +</span><span class="sc">{</span>improvements[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Stage 2→3: +</span><span class="sc">{</span>improvements[<span class="dv">2</span>]<span class="sc">:.2f}</span><span class="ss">%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Progressive Training Ergebnisse:
Gesamtverbesserung: 6.80%
Stage 1→2: +4.27%
Stage 2→3: +2.53%</code></pre>
</div>
</div>
<div id="24c7f336" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vergleich aller Ansätze</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>approach_names <span class="op">=</span> [<span class="st">'YOLOv8n</span><span class="ch">\n</span><span class="st">(Baseline)'</span>, <span class="st">'YOLOv8s</span><span class="ch">\n</span><span class="st">(Standard)'</span>, <span class="st">'YOLOv8s</span><span class="ch">\n</span><span class="st">(Progressive)'</span>, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'Beste Datensätze</span><span class="ch">\n</span><span class="st">(Kaggle)'</span>, <span class="st">'Augmentierte</span><span class="ch">\n</span><span class="st">Datensätze'</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>approach_mAP <span class="op">=</span> [<span class="fl">74.0</span>, <span class="fl">85.0</span>, <span class="fl">96.86</span>, <span class="fl">95.0</span>, <span class="fl">82.0</span>]  <span class="co"># Approximierte Werte</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'lightgray'</span>, <span class="st">'lightblue'</span>, <span class="st">'gold'</span>, <span class="st">'lightgreen'</span>, <span class="st">'lightcoral'</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>bars <span class="op">=</span> plt.bar(approach_names, approach_mAP, color<span class="op">=</span>colors, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Highlight der besten Performance</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>best_idx <span class="op">=</span> approach_mAP.index(<span class="bu">max</span>(approach_mAP))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>bars[best_idx].set_color(<span class="st">'gold'</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>bars[best_idx].set_edgecolor(<span class="st">'orange'</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>bars[best_idx].set_linewidth(<span class="dv">3</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Werte anzeigen</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar, mAP <span class="kw">in</span> <span class="bu">zip</span>(bars, approach_mAP):</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    plt.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, bar.get_height() <span class="op">+</span> <span class="fl">0.5</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'</span><span class="sc">{</span>mAP<span class="sc">:.1f}</span><span class="ss">%'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'mAP@0.5 (%)'</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gesamtvergleich: Verschiedene Optimierungsansätze'</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">60</span>, <span class="dv">105</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Markiere die beste Performance</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="bu">max</span>(approach_mAP), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="bu">len</span>(approach_names)<span class="op">-</span><span class="dv">1</span>, <span class="bu">max</span>(approach_mAP)<span class="op">+</span><span class="dv">1</span>, </span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>         <span class="ss">f'Beste Performance: </span><span class="sc">{</span><span class="bu">max</span>(approach_mAP)<span class="sc">:.2f}</span><span class="ss">%'</span>, </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>         ha<span class="op">=</span><span class="st">'right'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, color<span class="op">=</span><span class="st">'red'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="fazit-und-zusammenfassung" class="level2">
<h2 class="anchored" data-anchor-id="fazit-und-zusammenfassung">3. Fazit und Zusammenfassung</h2>
<section id="wichtigste-erkenntnisse" class="level3">
<h3 class="anchored" data-anchor-id="wichtigste-erkenntnisse">3.1 Wichtigste Erkenntnisse</h3>
<div id="d6c2b150" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zusammenfassung der wichtigsten Ergebnisse</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"WICHTIGSTE ERKENNTNISSE DER YOLO-HUNDEERKENNUNGS-ANALYSE"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">1. DATENSATZ-VERGLEICH:"</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • Kaggle-Datensatz: Beste Performance (mAP@0.5: 0.995)"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • dog_v1i: Starke Verbesserung durch Augmentation (0.56 → 0.82)"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • asdf_v1i: Moderate Verbesserung (0.29 → 0.68)"</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. DATENAUGMENTATION:"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • Massive Verbesserung für dog_v1i (+46.4%)"</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • Weniger Einfluss bei asdf_v1i (+134.5% aber niedriger Ausgangswert)"</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • Augmentation besonders wertvoll bei kleineren Datensätzen"</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. MODELL-PERFORMANCE:"</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • YOLOv8n zeigt konsistent gute Ergebnisse"</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • Schnelle Konvergenz innerhalb von 50 Epochen"</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • Stabile Validierungs-Performance ohne Overfitting"</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">4. TECHNISCHE ERKENNTNISSE:"</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • Konfidenz-Schwellwert 0.5 optimal für die meisten Fälle"</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • IoU-Schwellwert 0.5 standardmäßig gut geeignet"</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   • Datenqualität wichtiger als Datenmenge"</span>)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>============================================================
WICHTIGSTE ERKENNTNISSE DER YOLO-HUNDEERKENNUNGS-ANALYSE
============================================================

1. DATENSATZ-VERGLEICH:
   • Kaggle-Datensatz: Beste Performance (mAP@0.5: 0.995)
   • dog_v1i: Starke Verbesserung durch Augmentation (0.56 → 0.82)
   • asdf_v1i: Moderate Verbesserung (0.29 → 0.68)

2. DATENAUGMENTATION:
   • Massive Verbesserung für dog_v1i (+46.4%)
   • Weniger Einfluss bei asdf_v1i (+134.5% aber niedriger Ausgangswert)
   • Augmentation besonders wertvoll bei kleineren Datensätzen

3. MODELL-PERFORMANCE:
   • YOLOv8n zeigt konsistent gute Ergebnisse
   • Schnelle Konvergenz innerhalb von 50 Epochen
   • Stabile Validierungs-Performance ohne Overfitting

4. TECHNISCHE ERKENNTNISSE:
   • Konfidenz-Schwellwert 0.5 optimal für die meisten Fälle
   • IoU-Schwellwert 0.5 standardmäßig gut geeignet
   • Datenqualität wichtiger als Datenmenge
============================================================</code></pre>
</div>
</div>
</section>
<section id="performance-übersicht-aller-experimente" class="level3">
<h3 class="anchored" data-anchor-id="performance-übersicht-aller-experimente">3.2 Performance-Übersicht aller Experimente</h3>
<div id="179f5363" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Finale Performance-Tabelle</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>final_results <span class="op">=</span> pd.DataFrame({</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Datensatz'</span>: [<span class="st">'Kaggle'</span>, <span class="st">'dog_v1i (Original)'</span>, <span class="st">'dog_v1i (Augmentiert)'</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'asdf_v1i (Original)'</span>, <span class="st">'asdf_v1i (Augmentiert)'</span>],</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Precision'</span>: [<span class="fl">0.995</span>, <span class="fl">0.49</span>, <span class="fl">0.82</span>, <span class="fl">0.69</span>, <span class="fl">0.68</span>],</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Recall'</span>: [<span class="fl">0.995</span>, <span class="fl">0.63</span>, <span class="fl">0.79</span>, <span class="fl">0.71</span>, <span class="fl">0.71</span>],</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mAP@0.5'</span>: [<span class="fl">0.995</span>, <span class="fl">0.56</span>, <span class="fl">0.82</span>, <span class="fl">0.29</span>, <span class="fl">0.68</span>],</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mAP@0.5:0.95'</span>: [<span class="fl">0.77</span>, <span class="fl">0.32</span>, <span class="fl">0.51</span>, <span class="fl">0.15</span>, <span class="fl">0.39</span>],</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Trainingszeit'</span>: [<span class="st">'~30min'</span>, <span class="st">'~25min'</span>, <span class="st">'~45min'</span>, <span class="st">'~25min'</span>, <span class="st">'~45min'</span>],</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Verbesserung'</span>: [<span class="st">'-'</span>, <span class="st">'Baseline'</span>, <span class="st">'+46.4%'</span>, <span class="st">'Baseline'</span>, <span class="st">'+134.5%'</span>]</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"FINALE PERFORMANCE-ÜBERSICHT:"</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(final_results.to_string(index<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisierung der finalen Ergebnisse</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">6</span>))</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co"># mAP@0.5 Vergleich</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>datasets <span class="op">=</span> final_results[<span class="st">'Datensatz'</span>]</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>map_scores <span class="op">=</span> final_results[<span class="st">'mAP@0.5'</span>]</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'gold'</span>, <span class="st">'lightcoral'</span>, <span class="st">'darkred'</span>, <span class="st">'lightgreen'</span>, <span class="st">'darkgreen'</span>]</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>bars1 <span class="op">=</span> ax1.bar(<span class="bu">range</span>(<span class="bu">len</span>(datasets)), map_scores, color<span class="op">=</span>colors, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'mAP@0.5 Vergleich aller Experimente'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Datensatz'</span>)</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'mAP@0.5'</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>ax1.set_xticks(<span class="bu">range</span>(<span class="bu">len</span>(datasets)))</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(datasets, rotation<span class="op">=</span><span class="dv">45</span>, ha<span class="op">=</span><span class="st">'right'</span>)</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>ax1.set_ylim(<span class="dv">0</span>, <span class="fl">1.1</span>)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Werte an Balken</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar, score <span class="kw">in</span> <span class="bu">zip</span>(bars1, map_scores):</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    ax1.text(bar.get_x() <span class="op">+</span> bar.get_width()<span class="op">/</span><span class="fl">2.</span>, bar.get_height() <span class="op">+</span> <span class="fl">0.02</span>,</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f'</span><span class="sc">{</span>score<span class="sc">:.3f}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Augmentation Impact</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>aug_datasets <span class="op">=</span> [<span class="st">'dog_v1i'</span>, <span class="st">'asdf_v1i'</span>]</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>before <span class="op">=</span> [<span class="fl">0.56</span>, <span class="fl">0.29</span>]</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>after <span class="op">=</span> [<span class="fl">0.82</span>, <span class="fl">0.68</span>]</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>improvement <span class="op">=</span> [((a<span class="op">-</span>b)<span class="op">/</span>b)<span class="op">*</span><span class="dv">100</span> <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(after, before)]</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(aug_datasets))</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.35</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>bars2 <span class="op">=</span> ax2.bar(x <span class="op">-</span> width<span class="op">/</span><span class="dv">2</span>, before, width, label<span class="op">=</span><span class="st">'Vor Augmentation'</span>, color<span class="op">=</span><span class="st">'lightblue'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>bars3 <span class="op">=</span> ax2.bar(x <span class="op">+</span> width<span class="op">/</span><span class="dv">2</span>, after, width, label<span class="op">=</span><span class="st">'Nach Augmentation'</span>, color<span class="op">=</span><span class="st">'darkblue'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>)</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Einfluss der Datenaugmentation'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Datensatz'</span>)</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'mAP@0.5'</span>)</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>ax2.set_xticks(x)</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels(aug_datasets)</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Verbesserungs-Labels</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (b, a, imp) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(before, after, improvement)):</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>    ax2.text(i, <span class="bu">max</span>(b, a) <span class="op">+</span> <span class="fl">0.05</span>, <span class="ss">f'+</span><span class="sc">{</span>imp<span class="sc">:.1f}</span><span class="ss">%'</span>, ha<span class="op">=</span><span class="st">'center'</span>, </span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>            va<span class="op">=</span><span class="st">'bottom'</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FINALE PERFORMANCE-ÜBERSICHT:
================================================================================
             Datensatz  Precision  Recall  mAP@0.5  mAP@0.5:0.95 Trainingszeit Verbesserung
                Kaggle      0.995   0.995    0.995          0.77        ~30min            -
    dog_v1i (Original)      0.490   0.630    0.560          0.32        ~25min     Baseline
 dog_v1i (Augmentiert)      0.820   0.790    0.820          0.51        ~45min       +46.4%
   asdf_v1i (Original)      0.690   0.710    0.290          0.15        ~25min     Baseline
asdf_v1i (Augmentiert)      0.680   0.710    0.680          0.39        ~45min      +134.5%</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="combined_analysis_files/figure-html/cell-15-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="reproduzierbarkeit" class="level3">
<h3 class="anchored" data-anchor-id="reproduzierbarkeit">3.3 Reproduzierbarkeit</h3>
<p>Alle Experimente können mit den bereitgestellten Notebooks reproduziert werden:</p>
<ul>
<li><strong>baseline.qmd</strong>: Grundlegende Modelltrainings und Kaggle-Experimente</li>
<li><strong>einzelnes_training.qmd</strong>: Detaillierte Augmentations-Experimente<br>
</li>
<li><strong>combined_analysis.qmd</strong>: Diese umfassende Analyse</li>
</ul>
<p>Die verwendeten Datensätze und Modellgewichte sind im Repository verfügbar.</p>
<hr>
<p><strong>Autoren</strong>: Oliver Pejic &amp; Fabian Boni <strong>Datum</strong>: Juni 2025 <strong>Framework</strong>: YOLOv8, Python, Quarto</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>